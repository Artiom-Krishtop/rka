{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import {Dom, Event, Reflection, Tag, Type} from 'main.core';\nimport {type BaseEvent, EventEmitter} from 'main.core.events';\nimport {Loader} from 'main.loader';\n\nclass ImageInput\n{\n\tcontainer = null;\n\tloaderContainer = null;\n\taddButton = null;\n\tloader = null;\n\ttimeout = null;\n\tuploading = false;\n\n\tconstructor(params = {})\n\t{\n\t\tthis.instanceId = params.instanceId;\n\t\tthis.containerId = params.containerId;\n\t\tthis.loaderContainerId = params.loaderContainerId;\n\t\tthis.settings = params.settings || {};\n\n\t\tthis.disabled = params.disabled || false;\n\t\tif (this.disabled)\n\t\t{\n\t\t\tEvent.bind(this.getContainer(), 'click', (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\t\t}\n\n\t\tthis.addImageHandler = this.addImage.bind(this);\n\t\tthis.editImageHandler = this.editImage.bind(this);\n\n\t\tEventEmitter.subscribe('onUploaderIsInited', this.onUploaderIsInitedHandler.bind(this));\n\t}\n\n\tonUploaderIsInitedHandler(event: BaseEvent)\n\t{\n\t\tconst [id, uploader] = event.getCompatData();\n\n\t\tif (this.instanceId === id)\n\t\t{\n\t\t\tif (this.getPreviews().length > 0)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getFileWrapper(), 'ui-image-input-wrapper');\n\t\t\t}\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.getLoaderContainer() && (this.getLoaderContainer().style.display = 'none');\n\t\t\t\tthis.getContainer().style.display = '';\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe(uploader, 'onFileIsDeleted', this.onFileIsDeletedHandler.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onStart', this.onUploadStartHandler.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onDone', this.onUploadDoneHandler.bind(this));\n\t\t\tEventEmitter.subscribe(uploader, 'onFileCanvasIsLoaded', this.onFileCanvasIsLoadedHandler.bind(this));\n\n\t\t\tEventEmitter.subscribe('onDemandRecalculateWrapper', this.recalculateWrapper.bind(this));\n\t\t}\n\t}\n\n\tgetInputInstance()\n\t{\n\t\treturn BX.UI.FileInput.getInstance(this.instanceId);\n\t}\n\n\tgetFileInput()\n\t{\n\t\treturn this.getInputInstance().agent.fileInput;\n\t}\n\n\tgetContainer()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\tthis.container = document.getElementById(this.containerId);\n\n\t\t\tif (!Type.isDomNode(this.container))\n\t\t\t{\n\t\t\t\tthrow Error(`Can't find container with id ${this.containerId}`);\n\t\t\t}\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\tgetFileWrapper()\n\t{\n\t\tif (!this.fileWrapper)\n\t\t{\n\t\t\tthis.fileWrapper = this.getContainer().querySelector('.adm-fileinput-wrapper');\n\t\t}\n\n\t\treturn this.fileWrapper;\n\t}\n\n\tgetLoaderContainer()\n\t{\n\t\tif (!this.loaderContainer)\n\t\t{\n\t\t\tthis.loaderContainer = document.getElementById(this.loaderContainerId);\n\t\t}\n\n\t\treturn this.loaderContainer;\n\t}\n\n\tgetAddButton()\n\t{\n\t\tif (!this.addButton)\n\t\t{\n\t\t\tthis.addButton = this.getContainer().querySelector('[data-role=\"image-add-button\"]');\n\t\t}\n\n\t\treturn this.addButton;\n\t}\n\n\teditImage(event)\n\t{\n\t\tif (event.target === this.getFileInput())\n\t\t{\n\t\t\t// api call .click() to fire file upload dialog\n\t\t\tif (event.detail === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// disable default file dialog open\n\t\t\telse\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\tconst inputInstance = this.getInputInstance();\n\t\tconst items = inputInstance.agent.getItems().items;\n\n\t\tfor (let id in items)\n\t\t{\n\t\t\tif (items.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\t// hack to open editor (for unknown reasons the flag disappears)\n\t\t\t\tinputInstance.frameFlags.active = true;\n\t\t\t\tinputInstance.frameFiles(id);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\taddImage(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis.getFileInput().click();\n\t}\n\n\t/**\n\t * @returns {Loader}\n\t */\n\tgetLoader()\n\t{\n\t\tif (!this.loader)\n\t\t{\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.getFileWrapper().querySelector('.adm-fileinput-drag-area')\n\t\t\t});\n\t\t}\n\n\t\treturn this.loader;\n\t}\n\n\tshowLoader()\n\t{\n\t\tthis.getLoader().setOptions({\n\t\t\tsize: Math.min(this.getContainer().offsetHeight, this.getContainer().offsetWidth)\n\t\t});\n\t\tthis.getLoader().show();\n\t}\n\n\thideLoader()\n\t{\n\t\tthis.getLoader().hide();\n\t}\n\n\tonFileIsDeletedHandler()\n\t{\n\t\tthis.timeout = clearTimeout(this.timeout);\n\n\t\tthis.timeout = setTimeout(() => {\n\t\t\tthis.hideLoader();\n\t\t\tthis.recalculateWrapper();\n\t\t}, 100);\n\t}\n\n\tonUploadStartHandler(event: BaseEvent)\n\t{\n\t\tconst [stream] = event.getCompatData();\n\t\tif (stream)\n\t\t{\n\t\t\tthis.uploading = true;\n\t\t}\n\n\t\tclearTimeout(this.timeout);\n\n\t\tthis.timeout = setTimeout(() => {\n\t\t\tthis.showLoader();\n\t\t\tthis.recalculateWrapper();\n\t\t}, 100);\n\t}\n\n\tonUploadDoneHandler(event: BaseEvent)\n\t{\n\t\tconst [stream] = event.getCompatData();\n\t\tif (stream)\n\t\t{\n\t\t\tthis.uploading = false;\n\t\t\tthis.timeout = clearTimeout(this.timeout);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.hideLoader();\n\t\t\t\tthis.recalculateWrapper();\n\t\t\t});\n\t\t}\n\t}\n\n\tonFileCanvasIsLoadedHandler()\n\t{\n\t\tif (this.timeout && !this.uploading)\n\t\t{\n\t\t\tthis.uploading = false;\n\t\t\tthis.timeout = clearTimeout(this.timeout);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.hideLoader();\n\t\t\t\tthis.recalculateWrapper();\n\t\t\t});\n\t\t}\n\t}\n\n\tisMultipleInput()\n\t{\n\t\treturn this.getInputInstance().uploadParams.maxCount !== 1;\n\t}\n\n\tbuildShadowElement(wrapper)\n\t{\n\t\tif (wrapper.offsetParent === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet shadowElement = wrapper.querySelector('div.ui-image-item-shadow');\n\t\tif (!shadowElement)\n\t\t{\n\t\t\tshadowElement = Tag.render`<div class=\"ui-image-item-shadow\"></div>`;\n\t\t\tDom.prepend(shadowElement, wrapper);\n\t\t}\n\n\t\tconst canvas = wrapper.querySelector('canvas');\n\t\tif (canvas)\n\t\t{\n\t\t\tconst bottomMargin = 4;\n\n\t\t\tshadowElement.style.height = canvas.offsetHeight + 'px';\n\t\t\tshadowElement.style.width = canvas.offsetWidth - bottomMargin + 'px';\n\n\t\t\twrapper.querySelector('.adm-fileinput-item-preview').style.height = canvas.offsetHeight + 'px';\n\t\t\twrapper.closest('.adm-fileinput-item-wrapper').style.height = canvas.offsetHeight + 'px';\n\t\t}\n\t}\n\n\tgetPreviews()\n\t{\n\t\treturn this.getFileWrapper().querySelectorAll('.adm-fileinput-item');\n\t}\n\n\trecalculateWrapper()\n\t{\n\t\tconst wrapper = this.getFileWrapper();\n\t\tconst previews = this.getPreviews();\n\t\tconst length = Math.min(previews.length, 3);\n\n\t\tif (length)\n\t\t{\n\t\t\tthis.buildShadowElement(previews[0]);\n\n\t\t\tDom.addClass(wrapper, 'ui-image-input-wrapper');\n\t\t\tthis.getFileInput().style.display = 'none';\n\n\t\t\tEvent.unbind(wrapper, 'click', this.editImageHandler);\n\t\t\tEvent.bind(wrapper, 'click', this.editImageHandler);\n\n\t\t\tif (this.isMultipleInput())\n\t\t\t{\n\t\t\t\tthis.getAddButton().style.display = '';\n\n\t\t\t\tEvent.unbind(this.getAddButton(), 'click', this.addImageHandler);\n\t\t\t\tEvent.bind(this.getAddButton(), 'click', this.addImageHandler);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper');\n\t\t\tthis.getFileInput().style.display = '';\n\n\t\t\tEvent.unbind(wrapper, 'click', this.editImageHandler);\n\n\t\t\tif (this.isMultipleInput())\n\t\t\t{\n\t\t\t\tthis.getAddButton().style.display = 'none';\n\n\t\t\t\tEvent.unbind(this.getAddButton(), 'click', this.addImageHandler);\n\t\t\t}\n\t\t}\n\n\t\tswitch (length)\n\t\t{\n\t\t\tcase 3:\n\t\t\t\tDom.addClass(wrapper, 'ui-image-input-wrapper-multiple');\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-double');\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tDom.addClass(wrapper, 'ui-image-input-wrapper-double');\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-multiple');\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-double');\n\t\t\t\tDom.removeClass(wrapper, 'ui-image-input-wrapper-multiple');\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nReflection.namespace('BX.UI').ImageInput = ImageInput;"],"names":["ImageInput","params","instanceId","containerId","loaderContainerId","settings","disabled","Event","bind","getContainer","event","stopPropagation","preventDefault","addImageHandler","addImage","editImageHandler","editImage","EventEmitter","subscribe","onUploaderIsInitedHandler","getCompatData","id","uploader","getPreviews","length","Dom","addClass","getFileWrapper","requestAnimationFrame","getLoaderContainer","style","display","onFileIsDeletedHandler","onUploadStartHandler","onUploadDoneHandler","onFileCanvasIsLoadedHandler","recalculateWrapper","BX","UI","FileInput","getInstance","getInputInstance","agent","fileInput","container","document","getElementById","Type","isDomNode","Error","fileWrapper","querySelector","loaderContainer","addButton","target","getFileInput","detail","inputInstance","items","getItems","hasOwnProperty","frameFlags","active","frameFiles","click","loader","Loader","getLoader","setOptions","size","Math","min","offsetHeight","offsetWidth","show","hide","timeout","clearTimeout","setTimeout","hideLoader","stream","uploading","showLoader","uploadParams","maxCount","wrapper","offsetParent","shadowElement","Tag","render","prepend","canvas","bottomMargin","height","width","closest","querySelectorAll","previews","buildShadowElement","unbind","isMultipleInput","getAddButton","removeClass","Reflection","namespace"],"mappings":"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"}